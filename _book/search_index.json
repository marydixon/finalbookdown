[["linear-models.html", "Chapter 6 Linear Models 6.1 Instructor-Created Content 6.2 Assignment 6: Weather and Corn Yield Regressions", " Chapter 6 Linear Models The focus of the seventh week was on linear models. Nathan showed us how to create a USDA NASS API key. This key allows us to pull data from the USDA NASS into R using the function, rnassqs(). We used this data on weather and corn yield to analyze relationships between sets of parameters. These parameters were used in linear models. We discussed what the different components of a linear model are how to add quadratic trends to linear models. We learned that the p-values for the specific parameters indicate the level of significance for that parameter and the R2 value represents the percentage of variability explained by the model. The instructors wrote example code this week to pull in MATLAB files. The instructors also wrote code to pull in the USDA NASS data into R without having to navigate the NASS QuickStats website and download csv files. These data files of temperature and crop yield were combined and tidied. Nathan showed in his R code how to how to assign dimension names to a matrix and how to convert a matrix into a data frame. The packages used this week: tidyverse, a collection of R packages (dplyr, ggplot2, etc.) designed to wrangle and tidy data R.matlab, read in MATLAB file rnassqs, access to USDA NASS quick stats API to download data directly from USDA into R ggthemes, change the look of ggplots 6.1 Instructor-Created Content Weather Data Analysis Load the PRISM daily maximum temperatures # daily max temperature # dimensions: counties x days x years prism &lt;- readMat(&quot;data/prismiowa.mat&quot;) # look at county #1 t_1981_c1 &lt;- prism$tmaxdaily.iowa[1,,1] t_1981_c1[366] ## [1] NaN plot(1:366, t_1981_c1, type = &quot;l&quot;) ggplot() + geom_line(mapping = aes(x=1:366, y = t_1981_c1)) + theme_bw() + xlab(&quot;day of year&quot;) + ylab(&quot;daily maximum temperature (°C)&quot;) + ggtitle(&quot;Daily Maximum Temperature, Iowa County #1&quot;) ## Warning: Removed 1 row(s) containing missing values (geom_path). # assign dimension names to tmax matrix dimnames(prism$tmaxdaily.iowa) &lt;- list(prism$COUNTYFP, 1:366, prism$years) #wants a list corresponding to different dimensions - first dim is county code (FP code) # converted 3d matrix into a data frame tmaxdf &lt;- as.data.frame.table(prism$tmaxdaily.iowa) # relabel the columns colnames(tmaxdf) &lt;- c(&quot;countyfp&quot;,&quot;doy&quot;,&quot;year&quot;,&quot;tmax&quot;) tmaxdf &lt;- tibble(tmaxdf) Temperature trends Summer temperature trends: Winneshiek County tmaxdf$doy &lt;- as.numeric(tmaxdf$doy) tmaxdf$year &lt;- as.numeric(as.character(tmaxdf$year)) winnesummer &lt;- tmaxdf %&gt;% filter(countyfp==191 &amp; doy &gt;= 152 &amp; doy &lt;= 243) %&gt;% group_by(year) %&gt;% summarize(meantmax = mean(tmax)) ggplot(winnesummer, mapping = aes(x = year, y = meantmax)) + geom_point() + theme_bw() + labs(x = &quot;year&quot;, y = &quot;Tmax (°C)&quot;) + geom_smooth(method = lm) ## `geom_smooth()` using formula &#39;y ~ x&#39; lm_summertmax &lt;- lm(meantmax ~ year, winnesummer) summary(lm_summertmax) ## ## Call: ## lm(formula = meantmax ~ year, data = winnesummer) ## ## Residuals: ## Min 1Q Median 3Q Max ## -2.5189 -0.7867 -0.0341 0.6859 3.7415 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 41.57670 36.44848 1.141 0.262 ## year -0.00747 0.01823 -0.410 0.684 ## ## Residual standard error: 1.232 on 36 degrees of freedom ## Multiple R-squared: 0.004644, Adjusted R-squared: -0.02301 ## F-statistic: 0.168 on 1 and 36 DF, p-value: 0.6844 Winter Temperatures - Winneshiek County winnewinter &lt;- tmaxdf %&gt;% filter(countyfp==191 &amp; doy &lt;= 59 | doy &gt;= 335 &amp; !is.na(tmax)) %&gt;% group_by(year) %&gt;% summarize(meantmax = mean(tmax)) ggplot(winnewinter, mapping = aes(x = year, y = meantmax)) + geom_point() + theme_bw() + labs(x = &quot;year&quot;, y = &quot;Tmax (°C)&quot;) + geom_smooth(method = lm) lm_wintertmax &lt;- lm(meantmax ~ year, winnewinter) summary(lm_wintertmax) ## ## Call: ## lm(formula = meantmax ~ year, data = winnewinter) ## ## Residuals: ## Min 1Q Median 3Q Max ## -8.0748 -2.6494 0.7715 2.2172 4.1361 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -119.10546 94.08124 -1.266 0.214 ## year 0.05960 0.04705 1.267 0.213 ## ## Residual standard error: 3.181 on 36 degrees of freedom ## Multiple R-squared: 0.04267, Adjusted R-squared: 0.01608 ## F-statistic: 1.605 on 1 and 36 DF, p-value: 0.2134 Multiple regression  Quadratic time trend winnewinter$yearsq &lt;- winnewinter$year^2 lm_wintertmaxquad &lt;- lm(meantmax ~ year + yearsq, winnewinter) summary(lm_wintertmaxquad) ## ## Call: ## lm(formula = meantmax ~ year + yearsq, data = winnewinter) ## ## Residuals: ## Min 1Q Median 3Q Max ## -7.680 -2.813 0.640 2.264 4.072 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -1.049e+04 1.939e+04 -0.541 0.592 ## year 1.043e+01 1.940e+01 0.538 0.594 ## yearsq -2.594e-03 4.851e-03 -0.535 0.596 ## ## Residual standard error: 3.213 on 35 degrees of freedom ## Multiple R-squared: 0.05043, Adjusted R-squared: -0.003832 ## F-statistic: 0.9294 on 2 and 35 DF, p-value: 0.4043 winnewinter$fitted &lt;- lm_wintertmaxquad$fitted.values ggplot(winnewinter) + geom_point(mapping = aes(x = year, y = meantmax)) + geom_line(mapping = aes(x = year, y = fitted)) + theme_bw() + labs(x = &quot;year&quot;, y = &quot;tmax&quot;) Download NASS corn yield data # set our API key with NASS nassqs_auth(key = &quot;08EB8353-3696-30D9-96D4-839C4DEA18B4&quot;) # parameters to query on params &lt;- list(commodity_desc = &quot;CORN&quot;, util_practice_desc = &quot;GRAIN&quot;, prodn_practice_desc = &quot;ALL PRODUCTION PRACTICES&quot;, year__GE = 1981, state_alpha = &quot;IA&quot;) # download cornyieldsall &lt;- nassqs_yields(params) cornyieldsall$county_ansi &lt;- as.numeric(cornyieldsall$county_ansi) cornyieldsall$yield &lt;- as.numeric(cornyieldsall$Value) # clean and filter this dataset cornyields &lt;- select(cornyieldsall, county_ansi, county_name, yield, year) %&gt;% filter(!is.na(county_ansi) &amp; !is.na(yield)) cornyields &lt;- tibble(cornyields) 6.2 Assignment 6: Weather and Corn Yield Regressions Question 1A Extract Winneshiek County corn yields, fit a linear time trend, make a plot. Is there a significant time trend? winnecorn &lt;- cornyields %&gt;% filter(county_ansi==191) ggplot(winnecorn, mapping = aes(x = year, y = yield)) + geom_point() + labs(x = &quot;Year&quot;, y = &quot;Yield (bu/acre)&quot;, title = &quot;Winneshiek Corn Yield over Time&quot;) + geom_smooth(method = lm) + theme_bw() Figure 6.1: Linear time trend of Winneshiek County corn yields (bu/acre) lm_winnecorn &lt;- lm(yield ~ year, winnecorn) summary(lm_winnecorn) ## ## Call: ## lm(formula = yield ~ year, data = winnecorn) ## ## Residuals: ## Min 1Q Median 3Q Max ## -51.163 -1.841 2.363 9.437 24.376 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -4763.290 448.286 -10.63 4.46e-13 *** ## year 2.457 0.224 10.96 1.77e-13 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 16.97 on 39 degrees of freedom ## Multiple R-squared: 0.7551, Adjusted R-squared: 0.7488 ## F-statistic: 120.2 on 1 and 39 DF, p-value: 1.767e-13 From our linear model (6.1), we can see that there is a significant time trend. The p value for the year is less than alpha = 0.05. This agrees with the graph showing the yield data following the linear model line in a positive slope. With increasing years, there is a concomitant increase in yield. Question 1B Fit a quadratic time trend (i.e., year + year^2) and make a plot. Is there evidence for slowing yield growth? winnecorn$yearsq &lt;- winnecorn$year^2 lm_winnecornquad &lt;- lm(yield ~ year + yearsq, winnecorn) summary(lm_winnecornquad) ## ## Call: ## lm(formula = yield ~ year + yearsq, data = winnecorn) ## ## Residuals: ## Min 1Q Median 3Q Max ## -51.384 -3.115 1.388 9.743 25.324 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 2.583e+04 8.580e+04 0.301 0.765 ## year -2.812e+01 8.576e+01 -0.328 0.745 ## yearsq 7.641e-03 2.143e-02 0.357 0.723 ## ## Residual standard error: 17.17 on 38 degrees of freedom ## Multiple R-squared: 0.7559, Adjusted R-squared: 0.7431 ## F-statistic: 58.84 on 2 and 38 DF, p-value: 2.311e-12 winnecorn$fitted &lt;- lm_winnecornquad$fitted.values ggplot(winnecorn) + geom_point(mapping = aes(x = year, y = yield)) + geom_line(mapping = aes(x = year, y = fitted)) + theme_bw() + labs(x = &quot;Year&quot;, y = &quot;Yield (bu/acre)&quot;, title = &quot;Quadratic Time Trend for Corn Yield&quot;) Figure 6.2: Line graph with points showing a quadratic time progression of corn yield in Winneshiek County. ggplot(winnecorn) + geom_point(mapping = aes(x = year, y = yield)) + geom_smooth(mapping = aes(x = year, y = fitted), method = lm) + theme_bw() + labs(x = &quot;Year&quot;, y = &quot;Yield (bu/acre)&quot;, title = &quot;Quadratic Time Trend for Corn Yield&quot;) Figure 6.3: Quadratic time trend with year and year2 as predictors for corn yield in Winneshiek County. There is not sufficient evidence for slowing yield growth. The year squared estimate is positive and the year is negative, indicating that yield growth is not slowing. The p values for the individual estimates are also greater than alpha = 0.05. Question 2 Time Series: Lets analyze the relationship between temperature and yields for the Winneshiek County time series. Use data on yield and summer avg Tmax. Is adding year or Tmax^2 to your model helpful? Make a plot and interpret the results. Combine data for yield and temperature in Winneshiek County: summercorn &lt;- inner_join(winnecorn,winnesummer, by = &#39;year&#39;) summercorn$meantmaxsq &lt;- summercorn$meantmax^2 Make linear regression models with the different parameters of interest: lm_summercorn_single &lt;- lm(yield ~ meantmax, summercorn) summary(lm_summercorn_single) ## ## Call: ## lm(formula = yield ~ meantmax, data = summercorn) ## ## Residuals: ## Min 1Q Median 3Q Max ## -71.96 -19.85 -3.19 24.64 61.72 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 275.876 118.335 2.331 0.0255 * ## meantmax -4.763 4.438 -1.073 0.2902 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 32.88 on 36 degrees of freedom ## Multiple R-squared: 0.03101, Adjusted R-squared: 0.004098 ## F-statistic: 1.152 on 1 and 36 DF, p-value: 0.2902 summercorn$fittedsingle &lt;- lm_summercorn_single$fitted.values lm_summercorn_quad &lt;- lm(yield ~ meantmax + meantmaxsq, summercorn) summary(lm_summercorn_quad) ## ## Call: ## lm(formula = yield ~ meantmax + meantmaxsq, data = summercorn) ## ## Residuals: ## Min 1Q Median 3Q Max ## -56.587 -22.262 -0.982 22.409 52.798 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -4223.604 1446.639 -2.920 0.00609 ** ## meantmax 328.918 107.068 3.072 0.00410 ** ## meantmaxsq -6.173 1.979 -3.119 0.00362 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 29.5 on 35 degrees of freedom ## Multiple R-squared: 0.2417, Adjusted R-squared: 0.1984 ## F-statistic: 5.579 on 2 and 35 DF, p-value: 0.007887 summercorn$fittedquad &lt;- lm_summercorn_quad$fitted.values lm_summercorn_year &lt;- lm(yield ~ meantmax + year, summercorn) summary(lm_summercorn_year) ## ## Call: ## lm(formula = yield ~ meantmax + year, data = summercorn) ## ## Residuals: ## Min 1Q Median 3Q Max ## -53.071 -7.269 2.271 9.935 27.505 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -4791.774 513.812 -9.326 5.10e-11 *** ## meantmax -3.201 2.308 -1.387 0.174 ## year 2.514 0.253 9.934 1.01e-11 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 17.06 on 35 degrees of freedom ## Multiple R-squared: 0.7463, Adjusted R-squared: 0.7318 ## F-statistic: 51.48 on 2 and 35 DF, p-value: 3.761e-11 summercorn$fittedyear &lt;- lm_summercorn_year$fitted.values lm_summercorn &lt;- lm(yield ~ meantmax + year + meantmaxsq, summercorn) summary(lm_summercorn) ## ## Call: ## lm(formula = yield ~ meantmax + year + meantmaxsq, data = summercorn) ## ## Residuals: ## Min 1Q Median 3Q Max ## -44.683 -5.427 1.214 8.943 25.127 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -7280.2956 755.2808 -9.639 2.96e-11 *** ## meantmax 208.9004 52.9773 3.943 0.000381 *** ## year 2.3286 0.2166 10.752 1.77e-12 *** ## meantmaxsq -3.9259 0.9799 -4.006 0.000318 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 14.27 on 34 degrees of freedom ## Multiple R-squared: 0.8277, Adjusted R-squared: 0.8125 ## F-statistic: 54.43 on 3 and 34 DF, p-value: 4.538e-13 summercorn$fitted &lt;- lm_summercorn$fitted.values Plot the linear model results ggplot(summercorn) + geom_point(mapping = aes(x = meantmax, y = yield)) + geom_line(mapping = aes(x = meantmax, y = fittedsingle)) + theme_bw() + geom_smooth(mapping = aes(x = meantmax, y = fittedsingle), method = lm) + labs(x = &quot;Mean Max Temperature (°C)&quot;, y = &quot;Yield (bu/acre)&quot;, title = &quot;Corn Yield and Mean Maximum Summer Temperature&quot;) Figure 6.4: Mean maximum summer temperature (°C) of Winneshiek County as a predictor of corn yield (bu/acre) ggplot(summercorn) + geom_point(mapping = aes(x = meantmax, y = yield)) + geom_line(mapping = aes(x = meantmax, y = fittedquad)) + theme_bw() + labs(x = &quot;Mean Max Temperature (°C)&quot;, y = &quot;Yield (bu/acre)&quot;, title = &quot;Quadratic Temperature Trend for Corn Yield&quot;) Figure 6.5: Quadratic time trend (year2 ) of Winneshiek County as a predictor of corn yield (bu/acre) ggplot(summercorn) + geom_point(mapping = aes(x = meantmax, y = yield)) + theme_bw() + geom_smooth(mapping = aes(x = meantmax, y = fittedquad), method = lm) + labs(x = &quot;Mean Max Temperature (°C)&quot;, y = &quot;Yield (bu/acre)&quot;, title = &quot;Quadratic Temperature Trend for Corn Yield&quot;) Figure 6.6: Quadratic temperature trend (mean maximum temperature (°C)2 ) of Winneshiek County as a predictor of corn yield (bu/acre) ggplot(summercorn) + geom_point(mapping = aes(x = meantmax, y = yield)) + geom_smooth(mapping = aes(x = meantmax, y = fittedyear),method = lm) + theme_bw() + labs(x = &quot;Mean Max Temperature (°C)&quot;, y = &quot;Yield (bu/acre)&quot;, title = &quot;Years and Max Temperature as Corn Yield Predictors&quot;) Figure 6.7: Time in years and mean maximum temperature (°C) of Winneshiek County as a predictors of corn yield (bu/acre) ggplot(summercorn) + geom_point(mapping = aes(x = meantmax, y = yield)) + geom_smooth(mapping = aes(x = meantmax, y = fitted),method = lm) + theme_bw() + labs(x = &quot;Mean Max Temperature (°C)&quot;, y = &quot;Yield (bu/acre)&quot;, title = &quot;Years, Max Temperature, and Quadratic Temperature as Corn Yield Predictors&quot;) Figure 6.8: Time in years, mean maximum temperature (°C), and quadratic temperature of Winneshiek County as a predictors of corn yield (bu/acre) Adding tmax2 and year is helpful to the model. From the simple linear regression, we saw that the R-squared value is 0.03101, indicating that the mean max temperature observation only explains 3.101% of the variability in yield. When tmax^2 was added, the R-squared value increased to 0.1984. When year was added, R-sqaured increased to 0.7318. When year and tmax2 are added, the R-squared value changed to 0.8125, indicating that 81.25% of the variation within yield is explained by all predictors. These results suggest that adding year and tmax^2 make a stronger model. The estimate for mean max temperature squared is negative, indicating that temperature change is slowing. With increasing maximum temperature, there is a decrease in yield. With increasing years, there is an increase in corn yield. Question 3 Cross-Section: Analyze the relationship between temperature and yield across all counties in 2018. Is there a relationship? Interpret the results. Select data from 2018 and combine yield and temperature data: yield &lt;- cornyieldsall %&gt;% filter(year == 2018) %&gt;% group_by(county_name) %&gt;% unique() %&gt;% filter(!is.na(county_ansi)) temp &lt;- tmaxdf %&gt;% group_by(countyfp) %&gt;% filter(year == 2018) %&gt;% filter(doy &gt;= 152 &amp; doy &lt;= 243) %&gt;% summarize(meantmax = mean(tmax)) %&gt;% rename(county_ansi = &quot;countyfp&quot;) temp$county_ansi &lt;- as.numeric(as.character(temp$county_ansi)) summeryield &lt;- left_join(yield, temp, by=&#39;county_ansi&#39;) %&gt;% select(., county_ansi, county_name, yield, meantmax) Fit a simple and multiple regression model: lm_summeryield &lt;- lm(yield ~ meantmax, summeryield) summary(lm_summeryield) ## ## Call: ## lm(formula = yield ~ meantmax, data = summeryield) ## ## Residuals: ## Min 1Q Median 3Q Max ## -42.983 -15.041 0.955 16.795 31.999 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 312.466 63.387 4.929 3.69e-06 *** ## meantmax -4.216 2.241 -1.882 0.0631 . ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 19.64 on 91 degrees of freedom ## Multiple R-squared: 0.03745, Adjusted R-squared: 0.02687 ## F-statistic: 3.541 on 1 and 91 DF, p-value: 0.06308 summeryield$meantmaxsq &lt;- summeryield$meantmax^2 lm_summeryield_quad &lt;- lm(yield ~ meantmax + meantmaxsq, summeryield) summary(lm_summeryield_quad) ## ## Call: ## lm(formula = yield ~ meantmax + meantmaxsq, data = summeryield) ## ## Residuals: ## Min 1Q Median 3Q Max ## -44.221 -15.399 5.007 14.541 30.879 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -5501.602 1860.830 -2.957 0.00397 ** ## meantmax 406.789 131.493 3.094 0.00263 ** ## meantmaxsq -7.256 2.321 -3.126 0.00239 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 18.75 on 90 degrees of freedom ## Multiple R-squared: 0.1317, Adjusted R-squared: 0.1124 ## F-statistic: 6.827 on 2 and 90 DF, p-value: 0.001736 summeryield$fitted &lt;- lm_summeryield_quad$fitted.values Plot results of models: ggplot(summeryield, mapping = aes(x = meantmax, y = yield)) + geom_point() + labs(x = &quot;Mean Max Temperature (°C)&quot;, y = &quot;Yield (bu/acre)&quot;, title = &quot;Corn Yield and Mean Maximum Summer Temperature in 2018&quot;) + geom_smooth(method = lm) + theme_bw() Figure 6.9: Mean Maximum Summer Temperature (°C) as a predictor of corn Yield (bu/acre) in all Iowa counties in 2018. ggplot(summeryield) + geom_point(mapping = aes(x = meantmax, y = yield)) + geom_line(mapping = aes(x = meantmax, y = fitted)) + theme_bw() + labs(x = &quot;Mean Max Temperature (°C)&quot;, y = &quot;Yield (bu/acre)&quot;, title = &quot;Quadratic Temperature Trend for Corn Yield in 2018&quot;) Figure 6.10: 2018 corn yield (bu/acre) in all Iowa counties. The line shows temperature in a quadratic progression (mean maximum summer temperature (°C)2 ) and points show mean maximum summer temperature (°C). ggplot(summeryield) + geom_point(mapping = aes(x = meantmax, y = yield)) + geom_smooth(mapping = aes(x = meantmax, y = fitted), method = lm) + theme_bw() + labs(x = &quot;Mean Max Temperature (°C)&quot;, y = &quot;Yield (bu/acre)&quot;, title = &quot;Quadratic Temperature Trend for Corn Yield in 2018&quot;) Figure 6.11: Quadratic temperature trend (mean maximum summer temperature (°C)2 ) as a predictor of corn Yield (bu/acre) in all Iowa counties in 2018. From the graph of temperature and yield across all counties (6.11), we can see that there is a slight negative progression among the data. As temperature increases, yield decreases. The estimate from the simple linear model is negative, which supports the illustration in the graph. However, the p value from the simple linear regression is greater than alpha = 0.05, so we do not have sufficient evidence to conclude that there is a relationship. When mean temp max squared was added as an estimate in the model, the significance of the temperature predictors changed to less than alpha = 0.05. We can conclude from this model with temp and temp^2 as predictors, that there is a relationship between temperature and yield. Question 4 Panel: Convert the county ID code into factor using as.factor(), then include this variable in a regression using all counties yield and summer temperature data. How does the significance of your temperature coefficients (Tmax, Tmax2 ) change? Make a plot comparing actual and fitted yields and interpret the results of your model. Convert county ID into factor and join temperature and yield data: yieldall &lt;- cornyieldsall %&gt;% group_by(county_name) %&gt;% unique() %&gt;% filter(!is.na(county_ansi)) tempall &lt;- tmaxdf %&gt;% group_by(countyfp) %&gt;% filter(doy &gt;= 152 &amp; doy &lt;= 243) %&gt;% summarize(meantmax = mean(tmax)) %&gt;% rename(county_ansi = &quot;countyfp&quot;) tempall$county_ansi &lt;- as.numeric(as.character(tempall$county_ansi)) summeryieldall &lt;- left_join(yieldall, tempall, by=&#39;county_ansi&#39;) %&gt;% select(., county_ansi, county_name, yield, meantmax, year) summeryieldall$county_ansi &lt;- as.factor(summeryieldall$county_ansi) Run simple and multiple regression models: summeryieldall$meantmaxsq &lt;- summeryieldall$meantmax^2 lm_summeryieldall &lt;- lm(yield ~ meantmax + meantmaxsq, summeryieldall) summary(lm_summeryieldall) ## ## Call: ## lm(formula = yield ~ meantmax + meantmaxsq, data = summeryieldall) ## ## Residuals: ## Min 1Q Median 3Q Max ## -121.002 -22.522 -0.525 26.442 86.550 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -3680.191 844.714 -4.357 1.35e-05 *** ## meantmax 285.830 60.642 4.713 2.52e-06 *** ## meantmaxsq -5.325 1.088 -4.894 1.02e-06 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 35.29 on 4012 degrees of freedom ## Multiple R-squared: 0.0491, Adjusted R-squared: 0.04862 ## F-statistic: 103.6 on 2 and 4012 DF, p-value: &lt; 2.2e-16 lm_summeryield_panel &lt;- lm(yield ~ meantmax + meantmaxsq + county_ansi, summeryieldall) summary(lm_summeryield_panel) ## ## Call: ## lm(formula = yield ~ meantmax + meantmaxsq + county_ansi, data = summeryieldall) ## ## Residuals: ## Min 1Q Median 3Q Max ## -115.150 -22.076 -0.895 25.952 82.566 ## ## Coefficients: (2 not defined because of singularities) ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -8.131e+03 5.398e+03 -1.506 0.13206 ## meantmax 6.110e+02 3.926e+02 1.556 0.11971 ## meantmaxsq -1.126e+01 7.133e+00 -1.578 0.11454 ## county_ansi3 -5.811e+00 7.676e+00 -0.757 0.44905 ## county_ansi5 -6.793e+00 6.844e+00 -0.992 0.32105 ## county_ansi7 -1.623e+01 8.253e+00 -1.967 0.04930 * ## county_ansi9 -8.711e-01 7.185e+00 -0.121 0.90351 ## county_ansi11 -3.433e+00 7.612e+00 -0.451 0.65202 ## county_ansi13 -4.205e+00 7.649e+00 -0.550 0.58257 ## county_ansi15 7.454e+00 7.158e+00 1.041 0.29774 ## county_ansi17 1.167e-01 7.456e+00 0.016 0.98751 ## county_ansi19 -2.918e+00 7.323e+00 -0.398 0.69028 ## county_ansi21 -2.440e+00 7.683e+00 -0.318 0.75084 ## county_ansi23 -1.161e+00 7.690e+00 -0.151 0.87995 ## county_ansi25 -1.806e-02 7.650e+00 -0.002 0.99812 ## county_ansi27 2.105e+00 7.317e+00 0.288 0.77361 ## county_ansi29 7.371e+00 7.484e+00 0.985 0.32477 ## county_ansi31 5.293e+00 7.495e+00 0.706 0.48010 ## county_ansi33 -6.324e+00 7.010e+00 -0.902 0.36703 ## county_ansi35 3.255e+00 7.632e+00 0.427 0.66975 ## county_ansi37 -7.138e+00 6.879e+00 -1.038 0.29944 ## county_ansi39 -2.494e+01 8.065e+00 -3.092 0.00200 ** ## county_ansi41 -5.117e+00 7.647e+00 -0.669 0.50343 ## county_ansi43 -2.358e+00 7.095e+00 -0.332 0.73960 ## county_ansi45 4.344e-01 7.583e+00 0.057 0.95432 ## county_ansi47 -4.662e-01 7.433e+00 -0.063 0.94999 ## county_ansi49 8.485e+00 7.137e+00 1.189 0.23453 ## county_ansi51 -3.678e+00 1.234e+01 -0.298 0.76561 ## county_ansi53 -1.479e+01 8.834e+00 -1.674 0.09413 . ## county_ansi55 -1.107e+00 7.030e+00 -0.158 0.87485 ## county_ansi57 1.363e+01 8.795e+00 1.549 0.12139 ## county_ansi59 -9.503e+00 7.165e+00 -1.326 0.18479 ## county_ansi61 -3.571e-01 6.970e+00 -0.051 0.95914 ## county_ansi63 -4.546e+00 6.945e+00 -0.655 0.51274 ## county_ansi65 -2.783e+00 6.867e+00 -0.405 0.68530 ## county_ansi67 -6.171e+00 7.338e+00 -0.841 0.40041 ## county_ansi69 -3.550e-01 7.598e+00 -0.047 0.96274 ## county_ansi71 4.210e+01 2.262e+01 1.862 0.06275 . ## county_ansi73 1.060e+01 6.991e+00 1.516 0.12966 ## county_ansi75 7.736e-01 7.678e+00 0.101 0.91974 ## county_ansi77 1.762e+00 7.078e+00 0.249 0.80347 ## county_ansi79 2.387e+00 7.541e+00 0.317 0.75156 ## county_ansi81 -1.474e+00 6.932e+00 -0.213 0.83160 ## county_ansi83 2.638e+00 7.629e+00 0.346 0.72948 ## county_ansi85 9.046e+00 8.676e+00 1.043 0.29715 ## county_ansi87 1.063e+01 9.601e+00 1.107 0.26822 ## county_ansi89 -2.675e+00 9.051e+00 -0.296 0.76757 ## county_ansi91 -1.429e+00 7.322e+00 -0.195 0.84531 ## county_ansi93 1.744e+00 7.641e+00 0.228 0.81945 ## county_ansi95 -2.068e-02 7.073e+00 -0.003 0.99767 ## county_ansi97 -1.294e+01 7.622e+00 -1.697 0.08976 . ## county_ansi99 9.297e+00 7.064e+00 1.316 0.18818 ## county_ansi101 1.561e+01 1.485e+01 1.051 0.29331 ## county_ansi103 -2.953e+00 7.084e+00 -0.417 0.67680 ## county_ansi105 -5.033e+00 7.734e+00 -0.651 0.51521 ## county_ansi107 2.862e+00 7.820e+00 0.366 0.71439 ## county_ansi109 6.575e-01 7.222e+00 0.091 0.92746 ## county_ansi111 1.749e+01 1.488e+01 1.175 0.23988 ## county_ansi113 -5.180e+00 7.716e+00 -0.671 0.50201 ## county_ansi115 1.442e+01 1.007e+01 1.432 0.15209 ## county_ansi117 -2.228e+01 8.094e+00 -2.753 0.00593 ** ## county_ansi119 2.612e-01 7.526e+00 0.035 0.97231 ## county_ansi121 -3.731e+00 7.171e+00 -0.520 0.60294 ## county_ansi123 8.888e+00 7.583e+00 1.172 0.24125 ## county_ansi125 1.991e+00 7.735e+00 0.257 0.79689 ## county_ansi127 3.870e+00 7.700e+00 0.503 0.61528 ## county_ansi129 2.855e+01 1.652e+01 1.728 0.08406 . ## county_ansi131 -5.815e-02 7.260e+00 -0.008 0.99361 ## county_ansi133 8.667e+00 9.621e+00 0.901 0.36776 ## county_ansi135 -1.747e+01 7.455e+00 -2.344 0.01915 * ## county_ansi137 1.680e+01 1.111e+01 1.512 0.13071 ## county_ansi139 7.588e+00 7.370e+00 1.030 0.30325 ## county_ansi141 3.578e+00 7.680e+00 0.466 0.64133 ## county_ansi143 -2.783e+00 7.080e+00 -0.393 0.69430 ## county_ansi145 1.119e+01 1.140e+01 0.982 0.32629 ## county_ansi147 -4.178e+00 7.624e+00 -0.548 0.58377 ## county_ansi149 1.951e+00 7.078e+00 0.276 0.78284 ## county_ansi151 4.138e-01 7.721e+00 0.054 0.95726 ## county_ansi153 1.348e+01 7.406e+00 1.820 0.06886 . ## county_ansi155 1.546e+01 8.682e+00 1.780 0.07508 . ## county_ansi157 5.593e+00 6.988e+00 0.800 0.42352 ## county_ansi159 -1.981e+01 7.825e+00 -2.532 0.01137 * ## county_ansi161 -5.455e-01 7.676e+00 -0.071 0.94335 ## county_ansi163 7.564e+00 7.326e+00 1.032 0.30190 ## county_ansi165 3.609e-01 7.242e+00 0.050 0.96026 ## county_ansi167 8.327e+00 7.282e+00 1.144 0.25287 ## county_ansi169 1.817e-01 7.603e+00 0.024 0.98094 ## county_ansi171 -9.328e-01 7.608e+00 -0.123 0.90243 ## county_ansi173 -9.599e+00 8.955e+00 -1.072 0.28380 ## county_ansi175 -1.234e+01 7.352e+00 -1.678 0.09336 . ## county_ansi177 2.064e+01 2.129e+01 0.969 0.33236 ## county_ansi179 3.311e+00 1.016e+01 0.326 0.74458 ## county_ansi181 -3.579e+00 7.771e+00 -0.461 0.64509 ## county_ansi183 1.459e+01 9.259e+00 1.576 0.11510 ## county_ansi185 -2.220e+01 7.476e+00 -2.970 0.00300 ** ## county_ansi187 3.868e+00 7.664e+00 0.505 0.61381 ## county_ansi189 -1.066e+00 6.842e+00 -0.156 0.87621 ## county_ansi191 -3.217e+00 7.150e+00 -0.450 0.65273 ## county_ansi193 1.477e+00 7.009e+00 0.211 0.83310 ## county_ansi195 NA NA NA NA ## county_ansi197 NA NA NA NA ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 34.65 on 3916 degrees of freedom ## Multiple R-squared: 0.1048, Adjusted R-squared: 0.08245 ## F-statistic: 4.68 on 98 and 3916 DF, p-value: &lt; 2.2e-16 summeryieldall$fitted &lt;- lm_summeryield_panel$fitted.values Plot actual and fitted yields: ggplot(summeryieldall) + geom_point(mapping = aes(x = yield, y = fitted)) + geom_smooth(mapping = aes(x = yield, y = fitted),method = lm) + theme_few() + labs(x = &quot;Actual Yield&quot;, y = &quot;Fitted Yield&quot;, title = &quot;Fitted Versus Actual Corn Yields For Summer&quot;) Figure 6.12: Fitted and actual summer corn yields (bu/acre) for all Iowa counties. Our panel regression model has an adjusted R-squared value of 0.08245, so only 8.245% of the variation within yield is explained by predictors. The mean max temperature and mean max temperature squared have p values greater than alpha = 0.05, so we do not have sufficient evidence to conclude that there is a relationship between these temperature values and corresponding yield. The significance of the temperature coefficients changed when we added the county ansi to the model. When the linear model included mean max temperature and mean max temperature squared, the p values were less than alpha = 0.05, indicating statistical significance. When county ansi was added, the p values for the temperature coefficients increased to greater than alpha = 0.05, indicating a lack of statistical significance. Question 5 Soybeans: Download NASS data on soybean yields and explore either a time series relationship for a given county, the cross-sectional relationship for a given year, or a panel across all counties and years. Download soybean data: soybeanparams &lt;- list(commodity_desc = &quot;SOYBEANS&quot;, statisticcat_desc= &quot;YIELD&quot;, prodn_practice_desc = &quot;ALL PRODUCTION PRACTICES&quot;, year__GE = 1981, state_alpha = &quot;IA&quot;) soyall &lt;- nassqs_yields(soybeanparams) soyall$county_ansi &lt;- as.numeric(soyall$county_ansi) soyall$yield &lt;- as.numeric(soyall$Value) soyyield &lt;- select(soyall, county_ansi, county_name, yield, year) %&gt;% filter(!is.na(county_ansi) &amp; !is.na(yield)) soyyield &lt;- tibble(soyyield) Cross-sectional relationship of soybean yield and mean summer max temperature for the year 2015: soyyield2015 &lt;- soyall %&gt;% filter(year == 2015) %&gt;% group_by(county_name) %&gt;% unique() %&gt;% filter(!is.na(county_ansi)) soytemp2015 &lt;- tmaxdf %&gt;% group_by(countyfp) %&gt;% filter(year == 2015) %&gt;% filter(doy &gt;= 152 &amp; doy &lt;= 243) %&gt;% summarize(meantmax = mean(tmax)) %&gt;% rename(county_ansi = &quot;countyfp&quot;) soytemp2015$county_ansi &lt;- as.numeric(as.character(soytemp2015$county_ansi)) soy2015 &lt;- left_join(soyyield2015, soytemp2015, by=&#39;county_ansi&#39;) %&gt;% select(., county_ansi, county_name, yield, meantmax) lm_soyyield &lt;- lm(yield ~ meantmax, soy2015) summary(lm_soyyield) ## ## Call: ## lm(formula = yield ~ meantmax, data = soy2015) ## ## Residuals: ## Min 1Q Median 3Q Max ## -11.0568 -2.4976 0.2312 1.9743 9.3812 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 166.5497 16.0416 10.382 &lt; 2e-16 *** ## meantmax -4.1582 0.6013 -6.915 5.38e-10 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 3.657 on 95 degrees of freedom ## Multiple R-squared: 0.3348, Adjusted R-squared: 0.3278 ## F-statistic: 47.82 on 1 and 95 DF, p-value: 5.384e-10 soy2015$meantmaxsq &lt;- soy2015$meantmax^2 lm_soy2015_quad &lt;- lm(yield ~ meantmax + meantmaxsq, soy2015) summary(lm_soy2015_quad) ## ## Call: ## lm(formula = yield ~ meantmax + meantmaxsq, data = soy2015) ## ## Residuals: ## Min 1Q Median 3Q Max ## -10.8646 -2.3046 0.4521 1.5551 8.7845 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -995.3104 603.6188 -1.649 0.1025 ## meantmax 82.7546 45.1420 1.833 0.0699 . ## meantmaxsq -1.6245 0.8437 -1.925 0.0572 . ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 3.606 on 94 degrees of freedom ## Multiple R-squared: 0.36, Adjusted R-squared: 0.3464 ## F-statistic: 26.44 on 2 and 94 DF, p-value: 7.744e-10 soy2015$fitted &lt;- lm_soy2015_quad$fitted.values ggplot(soy2015, mapping = aes(x = meantmax, y = yield)) + geom_point() + labs(x = &quot;Mean Max Temperature (°C)&quot;, y = &quot;Yield (bu/acre)&quot;, title = &quot;Soybean Yield and Mean Maximum Summer Temperature&quot;) + geom_smooth(method = lm) + theme_bw() Figure 6.13: Mean maximum summer temperature (°C) in 2015 as a predictor for soybean yield (bu/acre) for all Iowa counties. ggplot(soy2015) + geom_point(mapping = aes(x = meantmax, y = yield)) + geom_line(mapping = aes(x = meantmax, y = fitted)) + theme_bw() + labs(x = &quot;Mean Max Temperature (°C)&quot;, y = &quot;Yield (bu/acre)&quot;, title = &quot;Soybean Yield and Quadratic Trend of Mean Maximum Summer Temperature&quot;) Figure 6.14: Quadratric temperature trend (mean maximum summer temperature (°C)2 ) in 2015 and soybean yield (bu/acre) for all Iowa counties. ggplot(soy2015) + geom_point(mapping = aes(x = meantmax, y = yield)) + geom_smooth(mapping = aes(x = meantmax, y = fitted), method = lm) + theme_bw() + labs(x = &quot;Mean Max Temperature (°C)&quot;, y = &quot;Yield (bu/acre)&quot;, title = &quot;Soybean Yield and Quadratic Trend of Mean Maximum Summer Temperature&quot;) Figure 6.15: Quadratric temperature trend (mean maximum summer temperature (°C)2 ) in 2015 as a predictor for soybean yield (bu/acre) for all Iowa counties. A simple linear regression of mean summer temperature and yield gives an R-squared value of 0.3348. We get a negative estimate of mean max summer temperature, indicating that as mean temperature decreases, yield increases. This finding is supported by the graph showing the relationship between yield and mean max temperature. This graph shows the data moving along a negative slope. The p value for the mean max temperature estimate is less than alpha = 0.05, suggesting we have enough evidence to claim a relationship between the predictor and yield. However, when we add mean max summer temperature squared to the model, the p value changes for each predictor to be greater than alpha = 0.05, so we cannot claim to have sufficient evidence to reject the null hypothesis using this model. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
